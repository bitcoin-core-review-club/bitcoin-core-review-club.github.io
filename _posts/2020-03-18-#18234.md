---
layout: pr
date: 2020-03-18
title: "Replace boost::mutex,condition_var,chrono with std equivalents in scheduler"
pr: 18234
authors: [ajtowns]
components: ["refactoring"]
host: MarcoFalke
status: upcoming
commit:
---

## Notes

- The scheduler was introduced in [#5964](https://github.com/bitcoin/bitcoin/pull/5964) as an alternative to threads,
  which are claimed to "have noticeable overhead on 32-bit systems".

- Bitcoin Core was historically (and still is to some extent) based heavily on the [Boost C++
  libraries](https://www.boost.org/). It is desirable to generally minimize the use of third-party libaries in Bitcoin
  Core, since a smaller footprint makes the code base easier to audit. To improve the user experience, for example the
  time it takes to compile Bitcoin Core with dependencies, and reduce the numerous Boost-related build-time issues, as
  well as run-time bugs, the eventual goal is to purely rely on the C++ standard libraries.

- Progress to replace Boost with the standard libaries is being tracked in the [Boost â†’ C++11 migration
  project](https://github.com/bitcoin/bitcoin/projects/3).

## Questions

1. Did you review the PR? [Concept ACK, approach ACK, tested ACK, or
NACK?](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#peer-review)
(Don't forget to put your PR review on GitHub.)

2. How many threads does the scheduler use?

3. What is the "scheduler queue"?

4. Name two example tasks that run in the scheduler. What would happen if the scheduler stopped working (dropped all
   events)?

5. What are the ways to stop the scheduler? How do they differ from each other?

6. What is the "scheduler lock"? Why is it needed and when is it locked/unlocked?

7. How good is the test coverage of the scheduler (functional and unit tests)?
   Do you think it can be improved?

<!-- TODO: uncomment and add meeting log
## Meeting Log
```
```
--->
